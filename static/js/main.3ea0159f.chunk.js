(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{14:function(e,t,n){e.exports={width100:"Mosaic_width100__2jt-x",widthS:"Mosaic_widthS__3p1_J",dispNone:"Mosaic_dispNone__3qLUa"}},17:function(e,t,n){e.exports={block:"PopUp_block__3mkAn",dispNone:"PopUp_dispNone__1foPo",line:"PopUp_line__1o5o_",width100:"PopUp_width100__3vPiY"}},26:function(e,t,n){e.exports={container:"src_container__Xu5Sk",linkActive:"src_linkActive__2Jb0z"}},28:function(e,t){var n=function(){onmessage=function(e){for(var t=e.data[0],n=e.data[1],a=t.data,r=0,i=0;i<a.length;i+=4)r+=parseInt(3*a[i]+4*a[i+1]+a[i+2]>>>3);var s=t.data.length/4;r=parseInt(r/s),postMessage([r,t,n])}}.toString();n=n.substring(n.indexOf("{")+1,n.lastIndexOf("}"));var a=new Blob([n],{type:"application/javascript"}),r=URL.createObjectURL(a);e.exports=r},29:function(e,t){var n=function(){onmessage=function(e){for(var t=e.data.isFull,n=e.data.lightness,a=e.data.imgData,r=e.data.imgidx,i=e.data.nOfSameLightnessImgs,s=new Uint8ClampedArray(a.data),o=0;o<s.length;o+=4){var c=parseInt(3*s[o]+4*s[o+1]+s[o+2]>>>3);s[o]=c,s[o+1]=c,s[o+2]=c}for(var l=[],h=-20;h<=10;h++)if(n+h>=5&&n+h<=245&&t[n+h]<=i){var v=new ImageData(a.width,a.height),u=new Uint8ClampedArray(s);if(h<0)for(var d=(n+h)/n,f=0;f<u.length;f+=4)u[f]*=d,u[f+1]*=d,u[f+2]*=d;else if(h>0)for(var m=0;m<u.length;m+=4)u[m]+=h,u[m+1]+=h,u[m+2]+=h;v.data.set(u),l.push([n+h,v,r])}postMessage(l)}}.toString();n=n.substring(n.indexOf("{")+1,n.lastIndexOf("}"));var a=new Blob([n],{type:"application/javascript"}),r=URL.createObjectURL(a);e.exports=r},42:function(e,t,n){"use strict";n.r(t);var a=n(7),r=n(11),i=n(12),s=n(23),o=n(20),c=n(0),l=n.n(c),h=n(25),v=n.n(h),u=n(30),d=n(2),f=n(26),m=n.n(f),p=n(27),g=n(21),x=n(22),b=function(){function e(t){Object(a.a)(this,e);var n={vars:null,consts:null,simulate:function(){},render:function(){},init:function(){},delete:function(){}};for(var r in n)"undefined"==typeof t[r]&&(t[r]=n[r]);this.vars=t.vars,this.consts=t.consts,this.simulate=t.simulate,this.render=t.render,this.init=t.init,this._delete=t.delete,this.simulResult=null,this._prevSResult=null,this.lastReq=null,this.canAnimRun=!0,this.canRender=!0}return Object(r.a)(e,[{key:"animStart",value:function(e){this._init(e),this.renderFrame()}},{key:"_init",value:function(e){this.canvas=e,this.context=e.getContext("2d"),this.init()}},{key:"renderFrame",value:function(e){this.lastReq=requestAnimationFrame(this.renderFrame.bind(this)),this.canAnimRun&&(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this._simulate(e),this.canRender&&this.render(e))}},{key:"renderPicture",value:function(e){this._init(e),this.canRender&&(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.render())}},{key:"_simulate",value:function(e){this.simulate(e)}},{key:"delete",value:function(){cancelAnimationFrame(this.lastReq),this._delete()}},{key:"drawPolygon",value:function(e){var t=this;console.assert(e&&e.length>2,"\ub2e4\uac01\ud615\uc744 \uad6c\uc131\ud558\ub294 \uc810\uc774 \ub108\ubb34 \uc791\uc2b5\ub2c8\ub2e4."),this.context.beginPath(),this.context.moveTo(e[0][0],e[0][1]),e.forEach((function(e){t.context.lineTo(e[0],e[1])})),this.context.closePath()}},{key:"fill",value:function(e){this.context.fillStyle=e,this.context.fill()}}],[{key:"rgb2hsv",value:function(e){var t=Math.max(e[0],e[1],e[2]),n=t-Math.min(e[0],e[1],e[2]),a=n&&(t===e[0]?(e[1]-e[2])/n:t===e[1]?2+(e[2]-e[0])/n:4+(e[0]-e[1])/n);return[Math.round(60*(a<0?a+6:a)),t&&n/t,t]}},{key:"hsv2rgb",value:function(e){var t=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e[0]/60)%6;return e[2]-e[2]*e[1]*Math.max(Math.min(n,4-n,1),0)};return[t(5),t(3),t(1)]}},{key:"getGreyScale",value:function(e){var t=e;return t.data&&(t=t.data),parseInt(3*t[0]+4*t[1]+t[2]>>>3)}},{key:"lightnessMul",value:function(e,t){for(var n=new ImageData(e.width,e.height),a=new Uint8ClampedArray(e.data),r=0;r<a.length;r+=4)a[r]*=t,a[r+1]*=t,a[r+2]*=t;return n.data.set(a),n}},{key:"lightnessAdd",value:function(e,t){for(var n=new ImageData(e.width,e.height),a=new Uint8ClampedArray(e.data),r=0;r<a.length;r+=4)a[r]+=t,a[r+1]+=t,a[r+2]+=t;return n.data.set(a),n}},{key:"img2greyScale",value:function(e){for(var t=e.data,n=0;n<t.length;n+=4){var a=parseInt(3*t[n]+4*t[n+1]+t[n+2]>>>3);t[n]=a,t[n+1]=a,t[n+2]=a}return e}},{key:"getSafeRect",value:function(e,t,n,a,r,i,s,o,c){var l=e.width,h=e.height;a<0&&(t+=a,a=Math.abs(a)),r<0&&(n+=r,r=Math.abs(r)),o<0&&(i+=o,o=Math.abs(o)),c<0&&(s+=c,c=Math.abs(c));var v=Math.max(t,0),u=Math.min(t+a,l),d=Math.max(n,0),f=Math.min(n+r,h),m=o/a,p=c/r;return[e,v,d,u-v,f-d,t<0?i-t*m:i,n<0?s-n*p:s,(u-v)*m,(f-d)*p]}}]),e}(),S=n(28),O=n.n(S),w=n(29),j=n.n(w),I=n(14),z=n.n(I),P=n(1),M=30,y=800,_=function e(){Object(a.a)(this,e),this.bannedList=new Set,this.imageIdx=null},U=l.a.memo((function(e){var t=Object(c.useRef)(null),n=Object(c.useRef)(null),a=Object(c.useRef)(null),r=Object(c.useRef)(null),i={},s=[];fetch("/99-interactions/data.json",{method:"GET"}).then((function(e){return e.json()})).then((function(e){s=e.value,r.current.crossOrigin="Anonymous",r.current.src=s[0].thumbnailUrl}));var o=function(e){return e.preventDefault()},l=new b({consts:{setPos:function(e,t){l.vars.pos[0]+=e,l.vars.pos[1]+=t,l.vars.pos[2]+=e,l.vars.pos[3]+=t},zoom:function(e,t,n){var a=e/y,r=t/y;n*=l.vars.zoomScale;var i=l.vars.originSize/l.vars.zoomScale;l.vars.zoomScale=Math.min(l.vars.maxZoomScale,Math.max(1,l.vars.zoomScale+n));var s=l.vars.originSize/l.vars.zoomScale,o=i*a,c=i*r,h=s*a,v=s*r,u=l.consts.getClampVal(h-o,v-c),d=Object(x.a)(u,2),f=d[0],m=d[1];l.consts.setPos(f,m)},posToIdx:function(e,n){var a=e/t.current.clientWidth,r=n/t.current.clientWidth,i=l.vars.originSize/l.vars.zoomScale,s=i*a,o=i*r;return[Math.floor((-l.vars.pos[0]+s)/M),Math.floor((-l.vars.pos[1]+o)/M)]},click:function(n,a){var r=l.vars.curHoveredPos[0],i=l.vars.curHoveredPos[1];if(0<=r&&r<h.vars.numOfColPixel&&0<=i&&i<h.vars.numOfRowPixel&&null!==h.vars.mosaicInfo[i][r].imageIdx){var o=l.vars.originSize/l.vars.zoomScale,c=t.current.clientWidth/o,v=r*M*c,u=i*M*c,d=n-(v+=l.vars.pos[0]*c),f=a-(u+=l.vars.pos[1]*c),m=M*c,p=Math.floor(t.current.clientWidth/2-m),g=[0,0];n>t.current.clientWidth/2?g[0]=n+(m-d)-p:g[0]=n-d,a>t.current.clientWidth/2?g[1]=a+(m-f)-p:g[1]=a-f,g[0]=Math.min(t.current.clientWidth-p,Math.max(0,g[0]))+t.current.offsetLeft,g[1]=Math.min(t.current.clientWidth-p,Math.max(0,g[1]))+t.current.offsetTop;var x=h.vars.mosaicInfo[i][r].imageIdx,b=s[Math.floor(x)];e.popUp({popUpSize:p,popUpPos:g,imageId:b.imageId,name:b.name,thumbnail:b.thumbnail,thumbnailUrl:b.thumbnailUrl,webSearchUrl:b.webSearchUrl})}else e.popUp(null)},emp:function(e,t){var n=l.consts.posToIdx(e,t);0<=n[0]&&n[0]<h.vars.numOfColPixel&&0<=n[1]&&n[1]<h.vars.numOfRowPixel?l.vars.curHoveredPos=n:l.vars.curHoveredPos=[-100,-100]},move:function(e,t){if(l.vars.isInit&&l.vars.canMove){e=10*e/l.vars.zoomScale,t=10*t/l.vars.zoomScale;var n=l.consts.getClampVal(e,t),a=Object(x.a)(n,2);e=a[0],t=a[1],l.consts.setPos(e,t)}},getClampVal:function(e,t){var n=l.vars.originSize/l.vars.zoomScale;return n>=l.vars.originSize*l.vars.ratioW?(e=Math.max(-l.vars.pos[0],e),e=Math.min(n-l.vars.pos[2],e)):(e=Math.max(n-l.vars.pos[2],e),e=Math.min(-l.vars.pos[0],e)),n>=l.vars.originSize*l.vars.ratioH?(t=Math.max(-l.vars.pos[1],t),t=Math.min(n-l.vars.pos[3],t)):(t=Math.max(n-l.vars.pos[3],t),t=Math.min(-l.vars.pos[1],t)),[e,t]}},vars:{zoomScale:1,pos:[0,0,0,0],curHoveredPos:[-10,-10],isInit:!1,maxZoomScale:1,originSize:1e3,canMove:!1,ratioW:1,ratioH:1,radioOfPic:1},init:function(){l.vars.originSize=h.canvas.width>h.canvas.height?h.canvas.width:h.canvas.height,l.vars.ratioW=h.canvas.width/l.vars.originSize,l.vars.ratioH=h.canvas.height/l.vars.originSize,l.vars.pos[0]=l.vars.originSize*(1-l.vars.ratioW)/2,l.vars.pos[1]=l.vars.originSize*(1-l.vars.ratioH)/2,l.vars.pos[2]=l.vars.pos[0]+l.vars.originSize*l.vars.ratioW,l.vars.pos[3]=l.vars.pos[1]+l.vars.originSize*l.vars.ratioH,l.vars.maxZoomScale=l.vars.originSize*(100/M)/y,l.vars.radioOfPic=i.renderedPixel/l.vars.originSize;var e=l.vars.pos[0]+l.vars.pos[1];e>100&&l.consts.zoom(400,400,l.vars.originSize/(l.vars.originSize-1.7*e)-1),l.vars.isInit=!0},simulate:function(){var e=l.vars.originSize/l.vars.zoomScale,t=[-i.zeroX+l.vars.pos[0]*l.vars.radioOfPic,-i.zeroY+l.vars.pos[1]*l.vars.radioOfPic],n=i.renderedPixel/l.vars.zoomScale,a=24e3/e,r=l.vars.curHoveredPos.slice();r[0]=r[0]*M+l.vars.pos[0],r[1]=r[1]*M+l.vars.pos[1],r[0]*=y/e,r[1]*=y/e,l.simulResult={viewportSize:e,pos:l.vars.pos,picPos:t,viewportSizeForPic:n,hoveredPos:r,hoverLineSize:a}},render:function(){var e,t,n=l.simulResult;(e=l.context).drawImage.apply(e,Object(g.a)(b.getSafeRect(h.canvas,-n.pos[0],-n.pos[1],n.viewportSize,n.viewportSize,0,0,y,y))),l.context.beginPath(),l.context.lineTo(n.hoveredPos[0],n.hoveredPos[1]),l.context.lineTo(n.hoveredPos[0]+n.hoverLineSize,n.hoveredPos[1]),l.context.lineTo(n.hoveredPos[0]+n.hoverLineSize,n.hoveredPos[1]+n.hoverLineSize),l.context.lineTo(n.hoveredPos[0],n.hoveredPos[1]+n.hoverLineSize),l.context.closePath(),l.context.stroke(),l.context.globalAlpha=.2,(t=l.context).drawImage.apply(t,Object(g.a)(b.getSafeRect(r.current,-n.picPos[0],-n.picPos[1],n.viewportSizeForPic,n.viewportSizeForPic,0,0,y,y))),l.context.globalAlpha=1}}),h=new b({consts:{renderLightness:function(e){var t,n=Object(p.a)(h.vars.pos_lightness[e]);try{for(n.s();!(t=n.n()).done;){var a,r=t.value,i=h.vars.mosaicInfo,s=i[r[1]][r[0]],o=h.vars.imgs_lightness,c=new Array;for(var l in o[e]){var v=o[e][l].imgidx;s.bannedList.has(v)||c.push([l,v])}var u=Math.floor(Math.random()*c.length);c[u],s.imageIdx=c[u][1],a=o[e][c[u][0]];for(var d=-1;d<=1;d++)for(var f=-1;f<=1;f++){var m=r[0]+d,g=r[1]+f;i[g]&&i[g][m]&&i[g][m].bannedList.add(s.imageIdx)}h.context.putImageData(a,r[0]*M,r[1]*M)}}catch(x){n.e(x)}finally{n.f()}h.vars.imgs_lightness[e]=null,h.vars.pos_lightness[e]=null},nOfSameLightnessImgs:9},vars:{pos_lightness:new Array(256).fill(null).map((function(){return new Array})),imgs_lightness:new Array(256).fill(null).map((function(){return new Array})),imgInfo:[],isFull:new Array(256).fill(!1),base:0,numOfColPixel:0,numOfRowPixel:0,mosaicInfo:null,renderLightnessCnt:0},init:function(){h.context.strokeStyle="rgba(0, 0, 0, 0)";var e,t,n,s=r.current.width,o=r.current.height;s>=o?(e=s/80,o=(t=parseInt(o/e))*e,n=80):(e=o/80,s=(n=parseInt(s/e))*e,t=80),h.vars.mosaicInfo=new Array(t);for(var c=0;c<t;c++)h.vars.mosaicInfo[c]=new Array(n).fill(null).map((function(){return new _}));i.renderedW=s,i.renderedH=o,i.zeroX=(r.current.width-i.renderedW)/2,i.zeroY=(r.current.height-i.renderedH)/2,i.renderedPixel=s>o?s:o,a.current.width=n,a.current.height=t,a.current.getContext("2d").drawImage(r.current,i.zeroX,i.zeroY,i.renderedW,i.renderedH,0,0,n,t),h.vars.base=e,h.vars.numOfColPixel=n,h.vars.numOfRowPixel=t,h.canvas.width=n*M,h.canvas.height=t*M},render:function(){for(var e=h.vars,t=a.current.getContext("2d"),n=t.getImageData(0,0,e.numOfColPixel,e.numOfRowPixel).data,r=0;r<e.numOfRowPixel;r++)for(var i=0;i<e.numOfColPixel;i++){var o=r*M,c=i*M,v=4*(r*e.numOfColPixel+i),u=parseInt(3*n[v]+4*n[v+1]+n[v+2]>>>3);u=Math.max(0,u-10),h.context.fillStyle="rgb("+u+","+u+","+u+")",h.context.fillRect(c,o,M,M),e.pos_lightness[u].push([i,r])}l.canAnimRun=!0,l.canRender=!0,a.current.width=60,a.current.height=60;for(var d=function(e){t.drawImage(e.target,0,0,60,60);for(var n=[],a=e.target.idx,r=0;r<4;r++){var i=r%2*M,o=Math.floor(r/2)*M;n.push(t.getImageData(i,o,M,M))}if(window.Worker){var c=new Worker(O.a),l=new Worker(j.a);c.onmessage=function(e){for(var t=e.data[0],n=!0,a=-20;a<=10;a++)t+a>=5&&t+a<=245&&(h.vars.isFull[t+a]++,h.vars.isFull[t+a]<=h.consts.nOfSameLightnessImgs&&(n=!1));n||l.postMessage({isFull:h.vars.isFull,lightness:t,nOfSameLightnessImgs:h.consts.nOfSameLightnessImgs,imgData:e.data[1],imgidx:e.data[2]})},l.onmessage=function(e){for(var t=0;t<e.data.length;t++){var n=e.data[t][0];e.data[t][1].imgidx=e.data[t][2],h.vars.imgs_lightness[n].push(e.data[t][1]),h.vars.imgs_lightness[n].length>=h.consts.nOfSameLightnessImgs&&h.consts.renderLightness(n)}};for(var v=0;v<4;v++)c.postMessage([n[v],a+v/10])}else for(var u=0;u<4;u++){for(var d=b.img2greyScale(n[u]),f=0,m=d.data.length/4,p=0;p<d.data.length;p+=4)f+=d.data[p];f=parseInt(f/m);for(var g=-20;g<=10;g++)if(f+g>=10&&f+g<=235&&!h.vars.isFull[f+g]){if(g<0){var x=b.lightnessMul(d,(f+g)/f);x.imgidx=a+u/10,h.vars.imgs_lightness[f+g].push(x)}else if(g>0){var S=b.lightnessAdd(d,g);S.imgidx=a+u/10,h.vars.imgs_lightness[f+g].push(S)}else d.imgidx=a+u/10,h.vars.imgs_lightness[f+g].push(d);h.vars.imgs_lightness[f+g].length>=h.consts.nOfSameLightnessImgs&&(h.vars.isFull[f+g]=!0,h.consts.renderLightness(f+g))}}s[e.target.idx].tmpimg.onload=null,s[e.target.idx].tmpimg=null},f=0;f<s.length/2;f++){var m=new Image;m.crossOrigin="Anonymous",m.idx=f,m.addEventListener("load",d,{once:!0}),m.src=s[f].thumbnailUrl+"&w=100&h=100&c=7",s[f].tmpimg=m}}});Object(c.useEffect)((function(){return t.current.addEventListener("wheel",o),function(){h.delete(),l.delete()}}),[]);var v=!1,u=[],d=function(e){var n,a;e.touches?1==e.touches.length&&(n=e.touches[0].pageX-t.current.offsetLeft,a=e.touches[0].pageY-t.current.offsetTop,e.movementX=n-u[0],e.movementY=a-u[1]):(n=e.pageX-t.current.offsetLeft,a=e.pageY-t.current.offsetTop),l.consts.emp(n,a),l.consts.move(e.movementX,e.movementY)},f=function(e){u=e.touches?[e.touches[0].pageX-t.current.offsetLeft,e.touches[0].pageY-t.current.offsetTop]:[e.clientX,e.clientY],l.vars.canMove=!0},m=function(e){if(e.touches)u=null;else{var t=Math.abs(e.clientX-u[0]);t+=Math.abs(e.clientY-u[1]),v=!!t}l.vars.canMove=!1};return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("img",{className:z.a.dispNone,ref:r,onLoad:function(e){l.canRender=!1,l.canAnimRun=!1,h.renderPicture(n.current),l.animStart(t.current)}}),Object(P.jsx)("canvas",{className:z.a.width100,ref:t,width:y,height:y,onClick:function(e){if(!v){var n=e.pageX-t.current.offsetLeft,a=e.pageY-t.current.offsetTop;l.consts.click(n,a)}},onWheel:function(e){var n=e.pageX-t.current.offsetLeft,a=e.pageY-t.current.offsetTop;e.deltaY>0?l.consts.zoom(n,a,-.1):e.deltaY<0&&l.consts.zoom(n,a,.1)},onMouseMove:d,onMouseDown:f,onMouseUp:m,onMouseLeave:function(e){l.vars.canMove=!1},onTouchStart:f,onTouchMove:d,onTouchEnd:m,children:"\uc774 \ube0c\ub77c\uc6b0\uc800\ub294 \uce94\ubc84\uc2a4\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."}),Object(P.jsx)("canvas",{className:z.a.dispNone,ref:a,width:"100",height:"100"}),Object(P.jsx)("canvas",{className:z.a.dispNone,ref:n,width:"100",height:"100"})]})})),R=n(17),k=n.n(R);var L=function(e){var t;return null!==e.imageInfo&&(t={position:"absolute",left:"".concat(e.imageInfo.popUpPos[0],"px"),top:"".concat(e.imageInfo.popUpPos[1],"px"),width:"".concat(e.imageInfo.popUpSize,"px"),height:"".concat(e.imageInfo.popUpSize,"px")}),Object(P.jsx)(P.Fragment,{children:e.imageInfo&&Object(P.jsx)("div",{className:k.a.line,style:t,onMouseLeave:e.hide,children:Object(P.jsx)("img",{className:k.a.width100,src:e.imageInfo.thumbnailUrl+"&w=".concat(e.imageInfo.popUpSize,"&h=").concat(e.imageInfo.popUpSize,"&c=7")})})})},A=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={popUpInfo:null},r.popUp=r.popUp.bind(Object(i.a)(r)),r.hide=r.hide.bind(Object(i.a)(r)),r}return Object(r.a)(n,[{key:"popUp",value:function(e){null===e?this.hide():this.setState({popUpInfo:e})}},{key:"hide",value:function(){this.setState({popUpInfo:null})}},{key:"render",value:function(){return Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:m.a.container,children:[Object(P.jsx)("main",{children:Object(P.jsx)(U,{popUp:this.popUp})}),Object(P.jsx)(L,{imageInfo:this.state.popUpInfo,hide:this.hide})]})})}}]),n}(l.a.Component),C=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("header",{children:Object(P.jsx)("h1",{children:"\uc624\ub298\uc758 \uc0ac\uc9c4\uc740..."})}),Object(P.jsx)(u.a,{children:Object(P.jsxs)(d.c,{children:[Object(P.jsx)(d.a,{path:"/99-interactions",component:A}),Object(P.jsx)(d.a,{path:"*",children:"\uc5c6\uc74c"})]})}),Object(P.jsx)("footer",{children:Object(P.jsx)("p",{children:"contact : iginganza@gmail.com"})})]})}}]),n}(l.a.Component);v.a.render(Object(P.jsx)(C,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.3ea0159f.chunk.js.map