(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{13:function(e,t,a){e.exports={width100:"Mosaic_width100__2jt-x",widthS:"Mosaic_widthS__3p1_J",dispNone:"Mosaic_dispNone__3qLUa"}},24:function(e,t,a){e.exports={container:"src_container__Xu5Sk",linkActive:"src_linkActive__2Jb0z"}},26:function(e,t){var a=function(){onmessage=function(e){for(var t=e.data[0],a=e.data[1],n=t.data,s=0,r=0;r<n.length;r+=4)s+=parseInt(3*n[r]+4*n[r+1]+n[r+2]>>>3);var i=t.data.length/4;s=parseInt(s/i),postMessage([s,t,a])}}.toString();a=a.substring(a.indexOf("{")+1,a.lastIndexOf("}"));var n=new Blob([a],{type:"application/javascript"}),s=URL.createObjectURL(n);e.exports=s},27:function(e,t){var a=function(){onmessage=function(e){for(var t=e.data.isFull,a=e.data.lightness,n=e.data.imgData,s=e.data.imgidx,r=e.data.nOfSameLightnessImgs,i=new Uint8ClampedArray(n.data),o=0;o<i.length;o+=4){var c=parseInt(3*i[o]+4*i[o+1]+i[o+2]>>>3);i[o]=c,i[o+1]=c,i[o+2]=c}for(var l=[],v=-20;v<=10;v++)if(a+v>=5&&a+v<=245&&t[a+v]<=r){var h=new ImageData(n.width,n.height),u=new Uint8ClampedArray(i);if(v<0)for(var d=(a+v)/a,m=0;m<u.length;m+=4)u[m]*=d,u[m+1]*=d,u[m+2]*=d;else if(v>0)for(var f=0;f<u.length;f+=4)u[f]+=v,u[f+1]+=v,u[f+2]+=v;h.data.set(u),l.push([a+v,h,s])}postMessage(l)}}.toString();a=a.substring(a.indexOf("{")+1,a.lastIndexOf("}"));var n=new Blob([a],{type:"application/javascript"}),s=URL.createObjectURL(n);e.exports=s},35:function(e,t,a){e.exports={block:"PopUp_block__3mkAn",dispNone:"PopUp_dispNone__1foPo"}},41:function(e,t,a){"use strict";a.r(t);var n=a(8),s=a(11),r=a(12),i=a(21),o=a(19),c=a(0),l=a.n(c),v=a(23),h=a.n(v),u=a(28),d=a(2),m=a(24),f=a.n(m),p=a(7),g=a(25),x=a(20),b=function(){function e(t){Object(n.a)(this,e);var a={vars:null,consts:null,simulate:function(){},render:function(){},init:function(){},delete:function(){}};for(var s in a)"undefined"==typeof t[s]&&(t[s]=a[s]);this.vars=t.vars,this.consts=t.consts,this.simulate=t.simulate,this.render=t.render,this.init=t.init,this._delete=t.delete,this.simulResult=null,this._prevSResult=null,this.lastReq=null,this.canAnimRun=!0,this.canRender=!0}return Object(s.a)(e,[{key:"animStart",value:function(e){this._init(e),this.renderFrame()}},{key:"_init",value:function(e){this.canvas=e,this.context=e.getContext("2d"),this.init()}},{key:"renderFrame",value:function(e){this.lastReq=requestAnimationFrame(this.renderFrame.bind(this)),this.canAnimRun&&(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this._simulate(e),this.canRender&&this.render(e))}},{key:"renderPicture",value:function(e){this._init(e),this.canRender&&(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.render())}},{key:"_simulate",value:function(e){this.simulate(e)}},{key:"delete",value:function(){cancelAnimationFrame(this.lastReq),this._delete()}},{key:"drawPolygon",value:function(e){var t=this;console.assert(e&&e.length>2,"\ub2e4\uac01\ud615\uc744 \uad6c\uc131\ud558\ub294 \uc810\uc774 \ub108\ubb34 \uc791\uc2b5\ub2c8\ub2e4."),this.context.beginPath(),this.context.moveTo(e[0][0],e[0][1]),e.forEach((function(e){t.context.lineTo(e[0],e[1])})),this.context.closePath()}},{key:"fill",value:function(e){this.context.fillStyle=e,this.context.fill()}}],[{key:"rgb2hsv",value:function(e){var t=Math.max(e[0],e[1],e[2]),a=t-Math.min(e[0],e[1],e[2]),n=a&&(t===e[0]?(e[1]-e[2])/a:t===e[1]?2+(e[2]-e[0])/a:4+(e[0]-e[1])/a);return[Math.round(60*(n<0?n+6:n)),t&&a/t,t]}},{key:"hsv2rgb",value:function(e){var t=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e[0]/60)%6;return e[2]-e[2]*e[1]*Math.max(Math.min(a,4-a,1),0)};return[t(5),t(3),t(1)]}},{key:"getGreyScale",value:function(e){var t=e;return t.data&&(t=t.data),parseInt(3*t[0]+4*t[1]+t[2]>>>3)}},{key:"lightnessMul",value:function(e,t){for(var a=new ImageData(e.width,e.height),n=new Uint8ClampedArray(e.data),s=0;s<n.length;s+=4)n[s]*=t,n[s+1]*=t,n[s+2]*=t;return a.data.set(n),a}},{key:"lightnessAdd",value:function(e,t){for(var a=new ImageData(e.width,e.height),n=new Uint8ClampedArray(e.data),s=0;s<n.length;s+=4)n[s]+=t,n[s+1]+=t,n[s+2]+=t;return a.data.set(n),a}},{key:"img2greyScale",value:function(e){for(var t=e.data,a=0;a<t.length;a+=4){var n=parseInt(3*t[a]+4*t[a+1]+t[a+2]>>>3);t[a]=n,t[a+1]=n,t[a+2]=n}return e}}]),e}(),O=a(26),j=a.n(O),S=a(27),w=a.n(S),I=a(13),z=a.n(I),P=a(1),y=30,M=100,_=800,U=function e(){Object(n.a)(this,e),this.bannedList=new Set,this.imageIdx=null},R=l.a.memo((function(e){var t,a=Object(c.useRef)(null),n=Object(c.useRef)(null),s=Object(c.useRef)(null),r=Object(c.useRef)(null),i={},o=[];fetch("http://52.231.32.202/images",{method:"GET"}).then((function(e){return e.json()})).then((function(e){o=e.value,r.current.crossOrigin="Anonymous",r.current.src=o[0].thumbnailUrl}));var l=new b({consts:{setPos:function(e,t){l.vars.pos[0]+=e,l.vars.pos[1]+=t,l.vars.pos[2]+=e,l.vars.pos[3]+=t},zoom:function(e,t,a){var n=e/_,s=t/_;a*=l.vars.zoomScale;var r=l.vars.originSize/l.vars.zoomScale;l.vars.zoomScale=Math.min(l.vars.maxZoomScale,Math.max(1,l.vars.zoomScale+a));var i=l.vars.originSize/l.vars.zoomScale,o=r*n,c=r*s,v=i*n,h=i*s,u=l.consts.getClampVal(v-o,h-c),d=Object(x.a)(u,2),m=d[0],f=d[1];l.consts.setPos(m,f)},posToIdx:function(e,t){var a=e/_,n=t/_,s=l.vars.originSize/l.vars.zoomScale,r=s*a,i=s*n;return[Math.floor((-l.vars.pos[0]+r)/y),Math.floor((-l.vars.pos[1]+i)/y)]},click:function(t,n){var s=l.vars.curHoveredPos[0],r=l.vars.curHoveredPos[1];if(0<=s&&s<v.vars.numOfColPixel&&0<=r&&r<v.vars.numOfRowPixel&&null!==v.vars.mosaicInfo[r][s].imageIdx){var i=l.vars.originSize/l.vars.zoomScale,c=_/i,h=s*y*c,u=r*y*c,d=t-(h+=l.vars.pos[0]*c),m=n-(u+=l.vars.pos[1]*c),f=y*c,p=[0,0];p[0]=t>400?t+(f-d)-370:t-d,p[1]=n>400?n+(f-m)-370:n-m,p[0]=Math.max(0,p[0])+a.current.offsetLeft,p[1]=Math.max(0,p[1])+a.current.offsetTop;var g=v.vars.mosaicInfo[r][s].imageIdx,x=o[Math.floor(g)];e.popUp({popUpSize:370,popUpPos:p,imageId:x.imageId,name:x.name,thumbnail:x.thumbnail,thumbnailUrl:x.thumbnailUrl,webSearchUrl:x.webSearchUrl})}else e.popUp(null)},emp:function(e,t){var a=l.consts.posToIdx(e,t);0<=a[0]&&a[0]<v.vars.numOfColPixel&&0<=a[1]&&a[1]<v.vars.numOfRowPixel?l.vars.curHoveredPos=a:l.vars.curHoveredPos=[-100,-100]},move:function(e,t){if(l.vars.isInit&&l.vars.canMove){e=10*e/l.vars.zoomScale,t=10*t/l.vars.zoomScale;var a=l.consts.getClampVal(e,t),n=Object(x.a)(a,2);e=n[0],t=n[1],l.consts.setPos(e,t)}},getClampVal:function(e,t){var a=l.vars.originSize/l.vars.zoomScale;return a>=l.vars.originSize*l.vars.ratioW?(e=Math.max(-l.vars.pos[0],e),e=Math.min(a-l.vars.pos[2],e)):(e=Math.max(a-l.vars.pos[2],e),e=Math.min(-l.vars.pos[0],e)),a>=l.vars.originSize*l.vars.ratioH?(t=Math.max(-l.vars.pos[1],t),t=Math.min(a-l.vars.pos[3],t)):(t=Math.max(a-l.vars.pos[3],t),t=Math.min(-l.vars.pos[1],t)),[e,t]}},vars:{zoomScale:1,pos:[0,0,0,0],curHoveredPos:[-10,-10],isInit:!1,maxZoomScale:1,originSize:1e3,canMove:!1,ratioW:1,ratioH:1,radioOfPic:1},init:function(){l.vars.originSize=v.canvas.width>v.canvas.height?v.canvas.width:v.canvas.height,l.vars.ratioW=v.canvas.width/l.vars.originSize,l.vars.ratioH=v.canvas.height/l.vars.originSize,l.vars.pos[0]=l.vars.originSize*(1-l.vars.ratioW)/2,l.vars.pos[1]=l.vars.originSize*(1-l.vars.ratioH)/2,l.vars.pos[2]=l.vars.pos[0]+l.vars.originSize*l.vars.ratioW,l.vars.pos[3]=l.vars.pos[1]+l.vars.originSize*l.vars.ratioH,l.vars.maxZoomScale=l.vars.originSize*(100/y)/_,l.vars.radioOfPic=i.renderedPixel/l.vars.originSize;var e=l.vars.pos[0]+l.vars.pos[1];e>100&&l.consts.zoom(400,400,l.vars.originSize/(l.vars.originSize-1.7*e)-1),l.vars.isInit=!0},simulate:function(){var e=l.vars.originSize/l.vars.zoomScale,t=[-i.zeroX+l.vars.pos[0]*l.vars.radioOfPic,-i.zeroY+l.vars.pos[1]*l.vars.radioOfPic],a=i.renderedPixel/l.vars.zoomScale,n=24e3/e,s=l.vars.curHoveredPos.slice();s[0]=s[0]*y+l.vars.pos[0],s[1]=s[1]*y+l.vars.pos[1],s[0]*=_/e,s[1]*=_/e,l.simulResult={viewportSize:e,pos:l.vars.pos,picPos:t,viewportSizeForPic:a,hoveredPos:s,hoverLineSize:n}},render:function(){var e=l.simulResult;l.context.drawImage(v.canvas,-e.pos[0],-e.pos[1],e.viewportSize,e.viewportSize,0,0,_,_),l.context.beginPath(),l.context.lineTo(e.hoveredPos[0],e.hoveredPos[1]),l.context.lineTo(e.hoveredPos[0]+e.hoverLineSize,e.hoveredPos[1]),l.context.lineTo(e.hoveredPos[0]+e.hoverLineSize,e.hoveredPos[1]+e.hoverLineSize),l.context.lineTo(e.hoveredPos[0],e.hoveredPos[1]+e.hoverLineSize),l.context.closePath(),l.context.stroke(),l.context.globalAlpha=.15,l.context.drawImage(r.current,-e.picPos[0],-e.picPos[1],l.simulResult.viewportSizeForPic,l.simulResult.viewportSizeForPic,0,0,_,_),l.context.globalAlpha=1}}),v=new b({consts:{renderLightness:function(e){var t,a=Object(g.a)(v.vars.pos_lightness[e]);try{for(a.s();!(t=a.n()).done;){var n,s=t.value,r=v.vars.mosaicInfo,i=r[s[1]][s[0]],o=v.vars.imgs_lightness,c=new Array;for(var l in o[e]){var h=o[e][l].imgidx;i.bannedList.has(h)||c.push([l,h])}var u=Math.floor(Math.random()*c.length);c[u],i.imageIdx=c[u][1],n=o[e][c[u][0]];for(var d=-1;d<=1;d++)for(var m=-1;m<=1;m++){var f=s[0]+d,p=s[1]+m;r[p]&&r[p][f]&&r[p][f].bannedList.add(i.imageIdx)}v.context.putImageData(n,s[0]*y,s[1]*y)}}catch(x){a.e(x)}finally{a.f()}v.vars.imgs_lightness[e]=null,v.vars.pos_lightness[e]=null},nOfSameLightnessImgs:9},vars:{pos_lightness:new Array(256).fill(null).map((function(){return new Array})),imgs_lightness:new Array(256).fill(null).map((function(){return new Array})),imgInfo:[],isFull:new Array(256).fill(!1),base:0,numOfColPixel:0,numOfRowPixel:0,mosaicInfo:null,renderLightnessCnt:0},init:function(){v.context.strokeStyle="rgba(0, 0, 0, 0)";var e,t,a,n=r.current.width,o=r.current.height;n>=o?(e=n/M,o=(t=parseInt(o/e))*e,a=M):(e=o/M,n=(a=parseInt(n/e))*e,t=M),v.vars.mosaicInfo=new Array(t);for(var c=0;c<t;c++)v.vars.mosaicInfo[c]=new Array(a).fill(null).map((function(){return new U}));i.renderedW=n,i.renderedH=o,i.zeroX=(r.current.width-i.renderedW)/2,i.zeroY=(r.current.height-i.renderedH)/2,i.renderedPixel=n>o?n:o,s.current.width=a,s.current.height=t,s.current.getContext("2d").drawImage(r.current,i.zeroX,i.zeroY,i.renderedW,i.renderedH,0,0,a,t),v.vars.base=e,v.vars.numOfColPixel=a,v.vars.numOfRowPixel=t,v.canvas.width=a*y,v.canvas.height=t*y},render:function(){for(var e=v.vars,t=s.current.getContext("2d"),a=t.getImageData(0,0,e.numOfColPixel,e.numOfRowPixel).data,n=0;n<e.numOfRowPixel;n++)for(var r=0;r<e.numOfColPixel;r++){var i=n*y,c=r*y,h=4*(n*e.numOfColPixel+r),u=parseInt(3*a[h]+4*a[h+1]+a[h+2]>>>3);u=Math.max(0,u-10),v.context.fillStyle="rgb("+u+","+u+","+u+")",v.context.fillRect(c,i,y,y),e.pos_lightness[u].push([r,n])}l.canAnimRun=!0,l.canRender=!0,s.current.width=60,s.current.height=60;for(var d=function(e){t.drawImage(e.target,0,0,60,60);for(var a=[],n=e.target.idx,s=0;s<4;s++){var r=s%2*y,i=Math.floor(s/2)*y;a.push(t.getImageData(r,i,y,y))}if(window.Worker){var c=new Worker(j.a),l=new Worker(w.a);c.onmessage=function(e){for(var t=e.data[0],a=!0,n=-20;n<=10;n++)t+n>=5&&t+n<=245&&(v.vars.isFull[t+n]++,v.vars.isFull[t+n]<=v.consts.nOfSameLightnessImgs&&(a=!1));a||l.postMessage({isFull:v.vars.isFull,lightness:t,nOfSameLightnessImgs:v.consts.nOfSameLightnessImgs,imgData:e.data[1],imgidx:e.data[2]})},l.onmessage=function(e){for(var t=0;t<e.data.length;t++){var a=e.data[t][0];e.data[t][1].imgidx=e.data[t][2],v.vars.imgs_lightness[a].push(e.data[t][1]),v.vars.imgs_lightness[a].length>=v.consts.nOfSameLightnessImgs&&v.consts.renderLightness(a)}};for(var h=0;h<4;h++)c.postMessage([a[h],n+h/10])}else for(var u=0;u<4;u++){for(var d=b.img2greyScale(a[u]),m=0,f=d.data.length/4,p=0;p<d.data.length;p+=4)m+=d.data[p];m=parseInt(m/f);for(var g=-20;g<=10;g++)if(m+g>=10&&m+g<=235&&!v.vars.isFull[m+g]){if(g<0){var x=b.lightnessMul(d,(m+g)/m);x.imgidx=n+u/10,v.vars.imgs_lightness[m+g].push(x)}else if(g>0){var O=b.lightnessAdd(d,g);O.imgidx=n+u/10,v.vars.imgs_lightness[m+g].push(O)}else d.imgidx=n+u/10,v.vars.imgs_lightness[m+g].push(d);v.vars.imgs_lightness[m+g].length>=v.consts.nOfSameLightnessImgs&&(v.vars.isFull[m+g]=!0,v.consts.renderLightness(m+g))}}o[e.target.idx].tmpimg.onload=null,o[e.target.idx].tmpimg=null},m=0;m<o.length;m++){var f=new Image;f.crossOrigin="Anonymous",f.idx=m,f.addEventListener("load",d,{once:!0}),f.src=o[m].thumbnailUrl+"&w=100&h=100&c=7",o[m].tmpimg=f}}});Object(c.useEffect)((function(){return function(){v.delete(),l.delete()}}),[]);var h=!1,u=[];return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("img",{className:z.a.dispNone,ref:r,onLoad:function(e){l.canRender=!1,l.canAnimRun=!1,v.renderPicture(n.current),l.animStart(a.current)}}),Object(P.jsx)("canvas",(t={className:z.a.width100,ref:a,width:_,height:_},Object(p.a)(t,"className","asdf"),Object(p.a)(t,"onClick",(function(e){if(!h){var t=e.pageX-a.current.offsetLeft,n=e.pageY-a.current.offsetTop;l.consts.click(t,n)}})),Object(p.a)(t,"onWheel",(function(e){var t=e.pageX-a.current.offsetLeft,n=e.pageY-a.current.offsetTop;e.deltaY>0?l.consts.zoom(t,n,-.1):e.deltaY<0&&l.consts.zoom(t,n,.1)})),Object(p.a)(t,"onMouseMove",(function(e){var t=e.pageX-a.current.offsetLeft,n=e.pageY-a.current.offsetTop;l.consts.emp(t,n),l.consts.move(e.movementX,e.movementY)})),Object(p.a)(t,"onMouseDown",(function(e){u=[e.clientX,e.clientY],l.vars.canMove=!0})),Object(p.a)(t,"onMouseUp",(function(e){var t=Math.abs(e.clientX-u[0]);t+=Math.abs(e.clientY-u[1]),h=!!t,l.vars.canMove=!1})),Object(p.a)(t,"onMouseLeave",(function(e){l.vars.canMove=!1})),Object(p.a)(t,"children","\uc774 \ube0c\ub77c\uc6b0\uc800\ub294 \uce94\ubc84\uc2a4\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."),t)),Object(P.jsx)("canvas",{className:z.a.dispNone,ref:s,width:"100",height:"100"}),Object(P.jsx)("canvas",{className:z.a.dispNone,ref:n,width:"100",height:"100"})]})}));a(35);var k=function(e){var t;return null!==e.imageInfo&&(t={position:"absolute",left:"".concat(e.imageInfo.popUpPos[0],"px"),top:"".concat(e.imageInfo.popUpPos[1],"px"),width:"".concat(e.imageInfo.popUpSize,"px"),height:"".concat(e.imageInfo.popUpSize,"px")}),Object(P.jsx)(P.Fragment,{children:e.imageInfo&&Object(P.jsx)("div",{style:t,onMouseLeave:e.hide,children:Object(P.jsx)("img",{src:e.imageInfo.thumbnailUrl+"&w=".concat(e.imageInfo.popUpSize,"&h=").concat(e.imageInfo.popUpSize,"&c=7")})})})},L=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).state={popUpInfo:null},s.popUp=s.popUp.bind(Object(r.a)(s)),s.hide=s.hide.bind(Object(r.a)(s)),s}return Object(s.a)(a,[{key:"popUp",value:function(e){null===e?this.hide():null!==this.state.popUpInfo&&e.imageId===this.state.popUpInfo.imageId||this.setState({popUpInfo:e})}},{key:"hide",value:function(){this.setState({popUpInfo:null})}},{key:"render",value:function(){return Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:f.a.container,children:[Object(P.jsx)("main",{children:Object(P.jsx)(R,{popUp:this.popUp})}),Object(P.jsx)(k,{imageInfo:this.state.popUpInfo,hide:this.hide})]})})}}]),a}(l.a.Component),A=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("header",{children:Object(P.jsx)("h1",{children:"\uc624\ub298\uc758 \uc0ac\uc9c4\uc740..."})}),Object(P.jsx)(u.a,{children:Object(P.jsxs)(d.c,{children:[Object(P.jsx)(d.a,{path:"/99-interactions",component:L}),Object(P.jsx)(d.a,{path:"*",children:"\uc5c6\uc74c"})]})}),Object(P.jsx)("footer",{children:Object(P.jsx)("p",{children:"this will be footer"})})]})}}]),a}(l.a.Component);h.a.render(Object(P.jsx)(A,{}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.ec45c2bb.chunk.js.map